<!doctype html>
<html lang="fr">
  <head>
    <!-- 📱 META MOBILE FIRST -->
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, viewport-fit=cover, user-scalable=yes, minimum-scale=1.0, maximum-scale=5.0"
    />

    <!-- 🎯 PWA & MOBILE -->
    <link rel="manifest" href="/manifest.json" />
    <meta
      name="theme-color"
      content="#dc2626"
      media="(prefers-color-scheme: light)"
    />
    <meta
      name="theme-color"
      content="#b91c1c"
      media="(prefers-color-scheme: dark)"
    />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta
      name="apple-mobile-web-app-status-bar-style"
      content="black-translucent"
    />
    <meta name="apple-mobile-web-app-title" content="SOS Urgently" />
    <meta name="apple-touch-fullscreen" content="yes" />
    <link rel="apple-touch-icon" href="/icon-192x192.png" />
    <link
      rel="apple-touch-icon"
      sizes="180x180"
      href="/apple-touch-icon-180x180.png"
    />
    <link
      rel="apple-touch-icon"
      sizes="152x152"
      href="/apple-touch-icon-152x152.png"
    />
    <link
      rel="apple-touch-icon"
      sizes="120x120"
      href="/apple-touch-icon-120x120.png"
    />

    <!-- 🤖 ANDROID -->
    <meta name="mobile-web-app-capable" content="yes" />
    <meta name="application-name" content="SOS Urgently" />

    <!-- 🔍 SEO -->
    <title>SOS Expat & Travelers - Aide d'urgence pour expatriés</title>
    <meta
      name="description"
      content="Assistance urgente 24/7 pour expatriés francophones. Avocats, traducteurs, urgences médicales. Support immédiat partout dans le monde. Application mobile disponible."
    />
    <meta
      name="keywords"
      content="expat, urgence, assistance, avocat, francophone, voyage, expatrié, aide, 24/7, mobile"
    />
    <link rel="canonical" href="https://sosexpats.com" />

    <!-- 🚀 PERFORMANCE HINTS -->
    <link rel="preconnect" href="https://www.gstatic.com" crossorigin />
    <link rel="preconnect" href="https://firestore.googleapis.com" crossorigin />
    <link rel="preconnect" href="https://api.stripe.com" crossorigin />
    <link rel="preconnect" href="https://api.twilio.com" crossorigin />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link rel="dns-prefetch" href="https://fonts.googleapis.com" />
    <link rel="dns-prefetch" href="https://cdn.jsdelivr.net" />

    <!-- ⚡ PRELOADS -->
    <link
      rel="preload"
      href="/fonts/inter-var.woff2"
      as="font"
      type="font/woff2"
      crossorigin
    />
    <link rel="prefetch" href="/icon-512x512.png" />

    <!-- 🎨 ICONS & FAVICONS -->
    <link
      rel="icon"
      type="image/svg+xml"
      href="/favicon.svg"
      media="(prefers-color-scheme: light)"
    />
    <link
      rel="icon"
      type="image/svg+xml"
      href="/favicon-dark.svg"
      media="(prefers-color-scheme: dark)"
    />
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png" />
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png" />
    <link rel="shortcut icon" href="/favicon.ico" />

    <!-- 🌐 SOCIAL -->
    <meta property="og:type" content="website" />
    <meta property="og:url" content="https://sosexpats.com/" />
    <meta
      property="og:title"
      content="SOS Expat & Travelers - Aide d'urgence 24/7"
    />
    <meta
      property="og:description"
      content="Assistance urgente pour expatriés francophones. Avocats, traducteurs, urgences. Support immédiat mobile partout dans le monde."
    />
    <meta property="og:image" content="https://sosexpats.com/og-image-1200x630.jpg" />
    <meta property="og:image:width" content="1200" />
    <meta property="og:image:height" content="630" />
    <meta
      property="og:image:alt"
      content="SOS Expat - Application mobile d'assistance urgente"
    />
    <meta property="og:locale" content="fr_FR" />
    <meta property="og:site_name" content="SOS Expat & Travelers" />

    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:url" content="https://sosexpats.com/" />
    <meta
      name="twitter:title"
      content="SOS Expat & Travelers - Aide d'urgence mobile"
    />
    <meta
      name="twitter:description"
      content="App mobile d'assistance urgente pour expatriés. Avocats, traducteurs, urgences 24/7. Téléchargez l'app maintenant."
    />
    <meta
      name="twitter:image"
      content="https://sosexpats.com/twitter-image-1200x600.jpg"
    />
    <meta name="twitter:creator" content="@sosexpats" />
    <meta name="twitter:site" content="@sosexpats" />

    <!-- 🔍 BOTS -->
    <meta
      name="robots"
      content="index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1"
    />
    <meta
      name="googlebot"
      content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1"
    />
    <meta
      name="bingbot"
      content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1"
    />

    <!-- 🚀 CRITICAL BASELINE -->
    <script>
      // Critical CSS de base
      const criticalCSS = document.createElement("style");
      criticalCSS.textContent = `
        * { box-sizing: border-box; }
        html { -webkit-text-size-adjust: 100%; -webkit-tap-highlight-color: transparent; }
        body { margin: 0; font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', sans-serif;
               line-height: 1.6; -webkit-font-smoothing: antialiased; }
        #root { min-height: 100vh; }
        .loading { display: flex; align-items: center; justify-content: center; min-height: 100vh;
                  font-size: 18px; color: #666; }
        @media (max-width: 768px) {
          html { font-size: 16px; }
          body { padding: env(safe-area-inset-top) env(safe-area-inset-right) env(safe-area-inset-bottom) env(safe-area-inset-left); }
        }
      `;
      document.head.appendChild(criticalCSS);

      if ("connection" in navigator) {
        const c = navigator.connection;
        if (c.effectiveType === "slow-2g" || c.effectiveType === "2g") {
          document.documentElement.classList.add("slow-connection");
        }
      }
      if ("getBattery" in navigator) {
        navigator.getBattery().then((b) => {
          if (b.level < 0.2)
            document.documentElement.classList.add("low-battery");
        });
      }
    </script>

    <!-- 🎨 MOBILE THEME -->
    <style>
      .app-loading {
        position: fixed;
        inset: 0;
        width: 100%;
        height: 100%;
        background: linear-gradient(135deg, #dc2626 0%, #b91c1c 100%);
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
        font-size: 20px;
        z-index: 9999;
      }
      @supports (padding: max(0px)) {
        body {
          padding-left: max(12px, env(safe-area-inset-left));
          padding-right: max(12px, env(safe-area-inset-right));
        }
      }
      @media (prefers-color-scheme: dark) {
        .app-loading {
          background: linear-gradient(135deg, #b91c1c 0%, #991b1b 100%);
        }
      }
      @media (prefers-reduced-motion: reduce) {
        * {
          animation-duration: 0.01ms !important;
          transition-duration: 0.01ms !important;
        }
      }

      /* ✅ Police Inter */
      @font-face {
        font-family: "Inter var";
        src: url("/fonts/inter-var.woff2") format("woff2");
        font-weight: 100 900;
        font-display: swap;
        font-style: normal;
      }
      html {
        font-family: "Inter var", system-ui, -apple-system, BlinkMacSystemFont,
          "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", sans-serif;
      }
    </style>
  </head>

  <body>
    <!-- 📱 Loading -->
    <div id="app-loading" class="app-loading">
      <div>
        <div style="font-size: 32px; margin-bottom: 16px">🆘</div>
        <div>Chargement...</div>
      </div>
    </div>

    <!-- 🎯 App -->
    <div id="root"></div>

    <!-- 🚀 Remove loading on ready -->
    <script type="module">
      window.addEventListener("load", () => {
        const loading = document.getElementById("app-loading");
        if (loading) {
          setTimeout(() => {
            loading.style.opacity = "0";
            setTimeout(() => loading.remove(), 300);
          }, 500);
        }
      });
    </script>

    <!-- App entry -->
    <script type="module" src="/src/main.tsx"></script>

    <!-- 📱 SERVICE WORKER UI ONLY (no double register) -->
    <script>
      window.addEventListener("sw-update-available", () => {
        const ok = confirm(
          "Nouvelle version disponible. Actualiser maintenant ?"
        );
        if (ok) window.location.reload();
      });
    </script>

    <!-- ❌ No JS -->
    <noscript>
      <div
        style="padding:20px; text-align:center; font-family:sans-serif; background:#fee2e2; color:#991b1b;"
      >
        Cette application nécessite JavaScript pour fonctionner. Activez-le dans
        votre navigateur.
      </div>
    </noscript>
  </body>
</html>
