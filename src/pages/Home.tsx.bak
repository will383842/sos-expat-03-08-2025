import React, { useState, useEffect, useRef } from 'react';
import { Link } from 'react-router-dom';
import { 
  ArrowRight, 
  Phone, 
  Users, 
  Scale, 
  Star, 
  MapPin, 
  Clock, 
  Shield, 
  Globe,
  ChevronRight,
  CheckCircle,
  Sparkles,
  TrendingUp,
  Heart,
  MessageCircle,
  Award
} from 'lucide-react';
import Layout from '../components/layout/Layout';
import SEOHead from '../components/layout/SEOHead';
import HeroSection from '../components/home/HeroSection';
import ProfileCarousel from '../components/home/ProfileCarousel';
import { WorldMap } from '../components/map/WorldMap';
import { useApp } from '../contexts/AppContext';
import { useAuth } from '../contexts/AuthContext';

// Données structurées pour le SEO
const structuredData = {
  "@context": "https://schema.org",
  "@type": "Organization",
  "name": "SOS Expat & Travelers",
  "url": "https://sosexpats.com",
  "logo": "https://sosexpats.com/logo.png",
  "sameAs": [
    "https://www.facebook.com/sosexpats",
    "https://twitter.com/sosexpats",
    "https://www.linkedin.com/company/sosexpats"
  ],
  "contactPoint": {
    "@type": "ContactPoint",
    "telephone": "",
    "contactType": "customer service",
    "availableLanguage": ["French", "English"]
  },
  "description": "Plateforme d'assistance urgente pour expatriés francophones. Connectez-vous avec des avocats et expatriés vérifiés partout dans le monde."
};

// Hook pour les animations au scroll
const useIntersectionObserver = (options = {}) => {
  const [isVisible, setIsVisible] = useState(false);
  const ref = useRef<HTMLDivElement>(null);

  useEffect(() => {
    const observer = new IntersectionObserver(([entry]) => {
      setIsVisible(entry.isIntersecting);
    }, {
      threshold: 0.1,
      rootMargin: '50px',
      ...options
    });

    if (ref.current) {
      observer.observe(ref.current);
    }

    return () => observer.disconnect();
  }, []);

  return [ref, isVisible] as const;
};

// Composant pour les statistiques animées
const AnimatedCounter = ({ end, duration = 2000, suffix = '' }: { end: number; duration?: number; suffix?: string }) => {
  const [count, setCount] = useState(0);
  const [ref, isVisible] = useIntersectionObserver();
  const hasAnimated = useRef(false);

  useEffect(() => {
    if (isVisible && !hasAnimated.current) {
      hasAnimated.current = true;
      let startTime: number;
      const startCount = 0;
      
      const animate = (currentTime: number) => {
        if (!startTime) startTime = currentTime;
        const progress = Math.min((currentTime - startTime) / duration, 1);
        const currentCount = Math.floor(progress * (end - startCount) + startCount);
        
        setCount(currentCount);
        
        if (progress < 1) {
          requestAnimationFrame(animate);
        }
      };
      
      requestAnimationFrame(animate);
    }
  }, [isVisible, end, duration]);

  return (
    <div ref={ref} className="text-4xl sm:text-5xl lg:text-6xl font-black bg-gradient-to-r from-red-600 to-orange-500 bg-clip-text text-transparent">
      {count.toLocaleString()}{suffix}
    </div>
  );
};

// Section des statistiques
const StatsSection = () => {
  const { language } = useApp();
  const [ref, isVisible] = useIntersectionObserver();
  
  const stats = [
    {
      id: 'experts',
      value: 10000,
      suffix: '+',
      label: language === 'fr' ? 'Experts vérifiés' : 'Verified experts',
      icon: Users,
      color: 'text-blue-600'
    },
    {
      id: 'countries', 
      value: 120,
      suffix: '+',
      label: language === 'fr' ? 'Pays couverts' : 'Countries covered',
      icon: Globe,
      color: 'text-green-600'
    },
    {
      id: 'satisfaction',
      value: 98,
      suffix: '%',
      label: language === 'fr' ? 'Satisfaction client' : 'Client satisfaction',
      icon: Heart,
      color: 'text-red-600'
    },
    {
      id: 'response',
      value: 5,
      suffix: 'min',
      label: language === 'fr' ? 'Temps de réponse moyen' : 'Average response time',
      icon: Clock,
      color: 'text-purple-600'
    }
  ];

  return (
    <section className="py-16 sm:py-24 bg-gradient-to-br from-gray-50 via-white to-blue-50 relative overflow-hidden">
      {/* Fond décoratif */}
      <div className="absolute inset-0 opacity-30">
        <div className="absolute top-0 left-0 w-96 h-96 bg-gradient-to-br from-blue-200 to-purple-200 rounded-full blur-3xl -translate-x-1/2 -translate-y-1/2"></div>
        <div className="absolute bottom-0 right-0 w-96 h-96 bg-gradient-to-br from-red-200 to-orange-200 rounded-full blur-3xl translate-x-1/2 translate-y-1/2"></div>
      </div>
      
      <div className="relative max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <div className="text-center mb-16">
          <h2 className="text-3xl sm:text-4xl lg:text-5xl font-black text-gray-900 mb-6">
            {language === 'fr' ? 'Une communauté mondiale' : 'A global community'}
            <span className="block bg-gradient-to-r from-red-600 to-orange-500 bg-clip-text text-transparent">
              {language === 'fr' ? 'qui vous fait confiance' : 'that trusts us'}
            </span>
          </h2>
          <p className="text-xl text-gray-600 max-w-3xl mx-auto leading-relaxed">
            {language === 'fr' 
              ? 'Des milliers d\'expatriés dans le monde entier nous font confiance pour leurs besoins d\'assistance et de conseils juridiques.'
              : 'Thousands of expats worldwide trust us for their assistance and legal advisory needs.'
            }
          </p>
        </div>

        <div 
          ref={ref}
          className={`grid grid-cols-2 lg:grid-cols-4 gap-8 lg:gap-12 transition-all duration-1000 transform ${
            isVisible ? 'translate-y-0 opacity-100' : 'translate-y-10 opacity-0'
          }`}
        >
          {stats.map((stat) => {
            const Icon = stat.icon;
            return (
              <div key={stat.id} className="text-center group">
                <div className="relative mb-6">
                  <div className={`inline-flex items-center justify-center w-20 h-20 sm:w-24 sm:h-24 rounded-3xl bg-white shadow-xl border-2 border-gray-100 group-hover:scale-110 transition-transform duration-300 ${stat.color}`}>
                    <Icon className="w-10 h-10 sm:w-12 sm:h-12" />
                  </div>
                  <div className="absolute inset-0 rounded-3xl bg-gradient-to-r from-red-600/20 to-orange-500/20 blur-xl opacity-0 group-hover:opacity-100 transition-opacity duration-300"></div>
                </div>
                <AnimatedCounter end={stat.value} suffix={stat.suffix} />
                <p className="text-lg sm:text-xl font-semibold text-gray-700 mt-2">{stat.label}</p>
              </div>
            );
          })}
        </div>
      </div>
    </section>
  );
};

// Section des services avec design moderne
const ServicesSection = () => {
  const { language } = useApp();
  const [ref, isVisible] = useIntersectionObserver();

  const services = [
    {
      id: 'lawyer',
      title: language === 'fr' ? 'Consultation Avocat' : 'Lawyer Consultation',
      subtitle: language === 'fr' ? 'Conseils juridiques experts' : 'Expert legal advice',
      description: language === 'fr' 
        ? 'Obtenez des conseils juridiques professionnels de la part d\'avocats certifiés partout dans le monde.'
        : 'Get professional legal advice from certified lawyers worldwide.',
      price: '49€',
      duration: '20 min',
      icon: Scale,
      gradient: 'from-blue-600 to-indigo-600',
      lightGradient: 'from-blue-50 to-indigo-50',
      features: [
        language === 'fr' ? 'Avocats certifiés' : 'Certified lawyers',
        language === 'fr' ? 'Conseil personnalisé' : 'Personalized advice',
        language === 'fr' ? 'Support multilingue' : 'Multilingual support'
      ],
      href: '/sos-appel?type=lawyer'
    },
    {
      id: 'expat',
      title: language === 'fr' ? 'Conseil Expatrié' : 'Expat Advice',
      subtitle: language === 'fr' ? 'Expérience terrain' : 'Field experience',
      description: language === 'fr'
        ? 'Bénéficiez de l\'expérience d\'expatriés francophones qui connaissent parfaitement votre destination.'
        : 'Benefit from the experience of French-speaking expats who know your destination perfectly.',
      price: '19€',
      duration: '30 min',
      icon: Users,
      gradient: 'from-green-600 to-emerald-600',
      lightGradient: 'from-green-50 to-emerald-50',
      features: [
        language === 'fr' ? 'Expatriés expérimentés' : 'Experienced expats',
        language === 'fr' ? 'Conseils pratiques' : 'Practical advice',
        language === 'fr' ? 'Culture locale' : 'Local culture'
      ],
      href: '/sos-appel?type=expat'
    }
  ];

  return (
    <section className="py-16 sm:py-24 bg-white relative overflow-hidden">
      {/* Fond décoratif */}
      <div className="absolute inset-0 opacity-5">
        <div className="absolute top-1/4 left-1/4 w-72 h-72 bg-red-500 rounded-full blur-3xl"></div>
        <div className="absolute bottom-1/4 right-1/4 w-72 h-72 bg-blue-500 rounded-full blur-3xl"></div>
      </div>

      <div className="relative max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <div className="text-center mb-16">
          <div className="inline-flex items-center bg-gradient-to-r from-red-100 to-orange-100 rounded-full px-6 py-3 mb-6">
            <Sparkles className="w-5 h-5 text-red-600 mr-2" />
            <span className="text-red-700 font-semibold">
              {language === 'fr' ? 'Nos Services' : 'Our Services'}
            </span>
          </div>
          <h2 className="text-3xl sm:text-4xl lg:text-5xl font-black text-gray-900 mb-6">
            {language === 'fr' ? 'L\'aide dont vous avez besoin,' : 'The help you need,'}
            <span className="block bg-gradient-to-r from-red-600 to-orange-500 bg-clip-text text-transparent">
              {language === 'fr' ? 'quand vous en avez besoin' : 'when you need it'}
            </span>
          </h2>
        </div>

        <div 
          ref={ref}
          className={`grid grid-cols-1 lg:grid-cols-2 gap-8 lg:gap-12 transition-all duration-1000 transform ${
            isVisible ? 'translate-y-0 opacity-100' : 'translate-y-10 opacity-0'
          }`}
        >
          {services.map((service, index) => {
            const Icon = service.icon;
            return (
              <div 
                key={service.id}
                className={`group relative bg-gradient-to-br ${service.lightGradient} rounded-3xl p-8 lg:p-10 border border-gray-100 hover:shadow-2xl transition-all duration-500 hover:-translate-y-2 ${
                  index === 1 ? 'lg:translate-y-8' : ''
                }`}
              >
                {/* Badge prix */}
                <div className="absolute -top-4 -right-4">
                  <div className={`bg-gradient-to-r ${service.gradient} text-white rounded-2xl px-6 py-3 shadow-lg`}>
                    <div className="text-2xl font-black">{service.price}</div>
                    <div className="text-sm opacity-90">{service.duration}</div>
                  </div>
                </div>

                {/* Icône */}
                <div className={`inline-flex items-center justify-center w-16 h-16 bg-gradient-to-r ${service.gradient} rounded-2xl text-white mb-6 group-hover:scale-110 transition-transform duration-300 shadow-lg`}>
                  <Icon className="w-8 h-8" />
                </div>

                {/* Contenu */}
                <div className="mb-6">
                  <h3 className="text-2xl lg:text-3xl font-black text-gray-900 mb-2">
                    {service.title}
                  </h3>
                  <p className="text-lg font-semibold text-gray-600 mb-4">
                    {service.subtitle}
                  </p>
                  <p className="text-gray-700 leading-relaxed mb-6">
                    {service.description}
                  </p>
                </div>

                {/* Features */}
                <div className="mb-8 space-y-3">
                  {service.features.map((feature, idx) => (
                    <div key={idx} className="flex items-center">
                      <CheckCircle className="w-5 h-5 text-green-500 mr-3 flex-shrink-0" />
                      <span className="text-gray-700 font-medium">{feature}</span>
                    </div>
                  ))}
                </div>

                {/* CTA */}
                <Link
                  to={service.href}
                  className={`group/btn inline-flex items-center justify-center w-full bg-gradient-to-r ${service.gradient} text-white font-bold py-4 px-6 rounded-2xl hover:shadow-xl transition-all duration-300 hover:scale-105`}
                >
                  <Phone className="w-5 h-5 mr-3 group-hover/btn:rotate-12 transition-transform duration-300" />
                  <span className="text-lg">
                    {language === 'fr' ? 'Commencer maintenant' : 'Start now'}
                  </span>
                  <ArrowRight className="w-5 h-5 ml-3 group-hover/btn:translate-x-1 transition-transform duration-300" />
                </Link>
              </div>
            );
          })}
        </div>
      </div>
    </section>
  );
};

// Section d'inscription pour les experts
const ExpertSignupSection = () => {
  const { language } = useApp();
  const [ref, isVisible] = useIntersectionObserver();

  const expertTypes = [
    {
      id: 'lawyer',
      title: language === 'fr' ? 'Rejoignez-nous en tant qu\'Avocat' : 'Join us as a Lawyer',
      subtitle: language === 'fr' ? 'Développez votre clientèle internationale' : 'Grow your international clientele',
      description: language === 'fr'
        ? 'Offrez vos services juridiques à des milliers d\'expatriés dans le monde et développez vos revenus.'
        : 'Offer your legal services to thousands of expats worldwide and grow your income.',
      icon: Scale,
      gradient: 'from-purple-600 to-indigo-600',
      lightBg: 'bg-gradient-to-br from-purple-50 to-indigo-50',
      benefits: [
        language === 'fr' ? 'Clientèle internationale' : 'International clientele',
        language === 'fr' ? 'Revenus flexibles' : 'Flexible income',
        language === 'fr' ? 'Support marketing' : 'Marketing support',
        language === 'fr' ? 'Plateforme sécurisée' : 'Secure platform'
      ],
      href: '/register/lawyer',
      earnings: language === 'fr' ? 'Jusqu\'à 2000€/mois' : 'Up to €2000/month'
    },
    {
      id: 'expat',
      title: language === 'fr' ? 'Devenez Conseiller Expatrié' : 'Become an Expat Advisor',
      subtitle: language === 'fr' ? 'Partagez votre expérience d\'expatriation' : 'Share your expat experience',
      description: language === 'fr'
        ? 'Aidez d\'autres expatriés avec votre expérience locale et générez des revenus complémentaires.'
        : 'Help other expats with your local experience and generate additional income.',
      icon: Users,
      gradient: 'from-emerald-600 to-green-600',
      lightBg: 'bg-gradient-to-br from-emerald-50 to-green-50',
      benefits: [
        language === 'fr' ? 'Horaires flexibles' : 'Flexible hours',
        language === 'fr' ? 'Aide communautaire' : 'Community help',
        language === 'fr' ? 'Revenus passifs' : 'Passive income',
        language === 'fr' ? 'Formation incluse' : 'Training included'
      ],
      href: '/register/expat',
      earnings: language === 'fr' ? 'Jusqu\'à 800€/mois' : 'Up to €800/month'
    }
  ];

  return (
    <section className="py-16 sm:py-24 bg-gradient-to-br from-gray-900 via-gray-800 to-gray-900 relative overflow-hidden">
      {/* Fond animé */}
      <div className="absolute inset-0 opacity-20">
        <div className="absolute top-0 left-0 w-96 h-96 bg-gradient-to-br from-blue-500 to-purple-500 rounded-full blur-3xl animate-pulse"></div>
        <div className="absolute bottom-0 right-0 w-96 h-96 bg-gradient-to-br from-emerald-500 to-green-500 rounded-full blur-3xl animate-pulse delay-1000"></div>
      </div>

      <div className="relative max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <div className="text-center mb-16">
          <div className="inline-flex items-center bg-white/10 backdrop-blur-sm rounded-full px-6 py-3 mb-6">
            <TrendingUp className="w-5 h-5 text-white mr-2" />
            <span className="text-white font-semibold">
              {language === 'fr' ? 'Rejoignez l\'équipe' : 'Join the team'}
            </span>
          </div>
          <h2 className="text-3xl sm:text-4xl lg:text-5xl font-black text-white mb-6">
            {language === 'fr' ? 'Devenez expert' : 'Become an expert'}
            <span className="block bg-gradient-to-r from-blue-400 to-emerald-400 bg-clip-text text-transparent">
              {language === 'fr' ? 'et générez des revenus' : 'and generate income'}
            </span>
          </h2>
          <p className="text-xl text-gray-300 max-w-3xl mx-auto leading-relaxed">
            {language === 'fr'
              ? 'Rejoignez notre réseau d\'experts et aidez des expatriés tout en développant vos revenus.'
              : 'Join our network of experts and help expats while growing your income.'
            }
          </p>
        </div>

        <div 
          ref={ref}
          className={`grid grid-cols-1 lg:grid-cols-2 gap-8 lg:gap-12 transition-all duration-1000 transform ${
            isVisible ? 'translate-y-0 opacity-100' : 'translate-y-10 opacity-0'
          }`}
        >
          {expertTypes.map((expert, index) => {
            const Icon = expert.icon;
            return (
              <div 
                key={expert.id}
                className={`group relative ${expert.lightBg} rounded-3xl p-8 lg:p-10 border border-white/20 hover:shadow-2xl transition-all duration-500 hover:-translate-y-2 ${
                  index === 1 ? 'lg:translate-y-8' : ''
                }`}
              >
                {/* Badge revenus */}
                <div className="absolute -top-4 -right-4">
                  <div className={`bg-gradient-to-r ${expert.gradient} text-white rounded-2xl px-6 py-3 shadow-lg`}>
                    <div className="text-sm font-bold">{expert.earnings}</div>
                  </div>
                </div>

                {/* Icône */}
                <div className={`inline-flex items-center justify-center w-16 h-16 bg-gradient-to-r ${expert.gradient} rounded-2xl text-white mb-6 group-hover:scale-110 transition-transform duration-300 shadow-lg`}>
                  <Icon className="w-8 h-8" />
                </div>

                {/* Contenu */}
                <div className="mb-6">
                  <h3 className="text-2xl lg:text-3xl font-black text-gray-900 mb-2">
                    {expert.title}
                  </h3>
                  <p className="text-lg font-semibold text-gray-600 mb-4">
                    {expert.subtitle}
                  </p>
                  <p className="text-gray-700 leading-relaxed mb-6">
                    {expert.description}
                  </p>
                </div>

                {/* Bénéfices */}
                <div className="mb-8 space-y-3">
                  {expert.benefits.map((benefit, idx) => (
                    <div key={idx} className="flex items-center">
                      <Award className="w-5 h-5 text-amber-500 mr-3 flex-shrink-0" />
                      <span className="text-gray-700 font-medium">{benefit}</span>
                    </div>
                  ))}
                </div>

                {/* CTA */}
                <Link
                  to={expert.href}
                  className={`group/btn inline-flex items-center justify-center w-full bg-gradient-to-r ${expert.gradient} text-white font-bold py-4 px-6 rounded-2xl hover:shadow-xl transition-all duration-300 hover:scale-105`}
                >
                  <span className="text-lg">
                    {language === 'fr' ? 'Rejoindre maintenant' : 'Join now'}
                  </span>
                  <ChevronRight className="w-5 h-5 ml-3 group-hover/btn:translate-x-1 transition-transform duration-300" />
                </Link>
              </div>
            );
          })}
        </div>
      </div>
    </section>
  );
};

// Témoignages modernes
const TestimonialsSection = () => {
  const { language } = useApp();
  const [ref, isVisible] = useIntersectionObserver();

  const testimonials = [
    {
      id: 1,
      name: 'Sophie M.',
      role: language === 'fr' ? 'Expatriée au Canada' : 'Expat in Canada',
      avatar: 'https://images.unsplash.com/photo-1494790108755-2616c2c6b8e6?w=150&h=150&fit=crop&crop=face',
      rating: 5,
      text: language === 'fr'
        ? 'Service exceptionnel ! J\'ai trouvé un avocat spécialisé en immigration en moins de 5 minutes. Très professionnel.'
        : 'Exceptional service! I found an immigration lawyer in less than 5 minutes. Very professional.',
      service: language === 'fr' ? 'Consultation Avocat' : 'Lawyer Consultation'
    },
    {
      id: 2,
      name: 'Marc D.',
      role: language === 'fr' ? 'Expatrié en Thaïlande' : 'Expat in Thailand',
      avatar: 'https://images.unsplash.com/photo-1472099645785-5658abf4ff4e?w=150&h=150&fit=crop&crop=face',
      rating: 5,
      text: language === 'fr'
        ? 'L\'expatrié m\'a donné des conseils précieux pour mon installation. Une vraie aide pratique !'
        : 'The expat gave me valuable advice for my relocation. Real practical help!',
      service: language === 'fr' ? 'Conseil Expatrié' : 'Expat Advice'
    },
    {
      id: 3,
      name: 'Claire L.',
      role: language === 'fr' ? 'Expatriée en Australie' : 'Expat in Australia',
      avatar: 'https://images.unsplash.com/photo-1438761681033-6461ffad8d80?w=150&h=150&fit=crop&crop=face',
      rating: 5,
      text: language === 'fr'
        ? 'Interface très intuitive et experts compétents. Je recommande vivement pour tous les expatriés.'
        : 'Very intuitive interface and competent experts. I highly recommend for all expats.',
      service: language === 'fr' ? 'Consultation Avocat' : 'Lawyer Consultation'
    }
  ];

  return (
    <section className="py-16 sm:py-24 bg-gradient-to-br from-blue-50 via-white to-purple-50 relative overflow-hidden">
      <div className="relative max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <div className="text-center mb-16">
          <div className="inline-flex items-center bg-gradient-to-r from-blue-100 to-purple-100 rounded-full px-6 py-3 mb-6">
            <MessageCircle className="w-5 h-5 text-blue-600 mr-2" />
            <span className="text-blue-700 font-semibold">
              {language === 'fr' ? 'Témoignages' : 'Testimonials'}
            </span>
          </div>
          <h2 className="text-3xl sm:text-4xl lg:text-5xl font-black text-gray-900 mb-6">
            {language === 'fr' ? 'Ce que disent nos clients' : 'What our clients say'}
          </h2>
        </div>

        <div 
          ref={ref}
          className={`grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8 transition-all duration-1000 transform ${
            isVisible ? 'translate-y-0 opacity-100' : 'translate-y-10 opacity-0'
          }`}
        >
          {testimonials.map((testimonial, index) => (
            <div 
              key={testimonial.id}
              className={`bg-white rounded-3xl p-8 shadow-lg border border-gray-100 hover:shadow-xl transition-all duration-500 hover:-translate-y-2 ${
                index === 1 ? 'md:translate-y-8' : ''
              }`}
            >
              {/* Rating */}
              <div className="flex items-center mb-6">
                {[...Array(testimonial.rating)].map((_, i) => (
                  <Star key={i} className="w-5 h-5 text-yellow-400 fill-current" />
                ))}
              </div>

              {/* Texte */}
              <blockquote className="text-gray-700 mb-8 text-lg leading-relaxed">
                "{testimonial.text}"
              </blockquote>

              {/* Profil */}
              <div className="flex items-center">
                <img
                  src={testimonial.avatar}
                  alt={testimonial.name}
                  className="w-12 h-12 rounded-full object-cover mr-4"
                />
                <div>
                  <div className="font-bold text-gray-900">{testimonial.name}</div>
                  <div className="text-sm text-gray-600">{testimonial.role}</div>
                  <div className="text-xs text-blue-600 font-medium mt-1">{testimonial.service}</div>
                </div>
              </div>
            </div>
          ))}
        </div>
      </div>
    </section>
  );
};

// CTA Final Section
const FinalCTASection = () => {
  const { language } = useApp();
  const { user } = useAuth();
  const [ref, isVisible] = useIntersectionObserver();

  return (
    <section className="py-16 sm:py-24 bg-gradient-to-r from-red-600 via-red-700 to-orange-600 relative overflow-hidden">
      {/* Fond animé */}
      <div className="absolute inset-0">
        <div className="absolute top-0 left-0 w-full h-full bg-gradient-to-br from-red-600/20 to-orange-600/20"></div>
        <div className="absolute top-1/4 left-1/4 w-96 h-96 bg-white/10 rounded-full blur-3xl animate-pulse"></div>
        <div className="absolute bottom-1/4 right-1/4 w-96 h-96 bg-white/10 rounded-full blur-3xl animate-pulse delay-1000"></div>
      </div>

      <div className="relative max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
        <div 
          ref={ref}
          className={`transition-all duration-1000 transform ${
            isVisible ? 'translate-y-0 opacity-100' : 'translate-y-10 opacity-0'
          }`}
        >
          <h2 className="text-3xl sm:text-4xl lg:text-5xl font-black text-white mb-6">
            {language === 'fr' ? 'Prêt à obtenir de l\'aide ?' : 'Ready to get help?'}
          </h2>
          <p className="text-xl text-red-100 mb-12 max-w-2xl mx-auto leading-relaxed">
            {language === 'fr'
              ? 'Rejoignez des milliers d\'expatriés qui nous font confiance pour leurs urgences juridiques et pratiques.'
              : 'Join thousands of expats who trust us for their legal and practical emergencies.'
            }
          </p>

          {/* Avantages rapides */}
          <div className="grid grid-cols-1 sm:grid-cols-3 gap-6 mb-12">
            <div className="flex flex-col items-center text-white">
              <div className="bg-white/20 rounded-full p-4 mb-3">
                <Shield className="w-6 h-6" />
              </div>
              <span className="font-semibold">
                {language === 'fr' ? 'Sécurité garantie' : 'Guaranteed security'}
              </span>
            </div>
            <div className="flex flex-col items-center text-white">
              <div className="bg-white/20 rounded-full p-4 mb-3">
                <Clock className="w-6 h-6" />
              </div>
              <span className="font-semibold">
                {language === 'fr' ? 'Réponse < 5 min' : 'Response < 5 min'}
              </span>
            </div>
            <div className="flex flex-col items-center text-white">
              <div className="bg-white/20 rounded-full p-4 mb-3">
                <Globe className="w-6 h-6" />
              </div>
              <span className="font-semibold">
                {language === 'fr' ? '120+ pays' : '120+ countries'}
              </span>
            </div>
          </div>

          {/* CTA principal */}
          <div className="flex flex-col sm:flex-row gap-4 justify-center items-center">
            <Link
              to="/sos-appel"
              className="group inline-flex items-center justify-center bg-white text-red-600 px-8 py-4 rounded-2xl font-bold text-lg hover:bg-gray-50 transition-all duration-300 hover:scale-105 shadow-xl min-w-[250px]"
            >
              <Phone className="w-6 h-6 mr-3 group-hover:rotate-12 transition-transform duration-300" />
              {language === 'fr' ? 'Obtenir de l\'aide maintenant' : 'Get help now'}
              <ArrowRight className="w-6 h-6 ml-3 group-hover:translate-x-1 transition-transform duration-300" />
            </Link>
            
            {!user && (
              <Link
                to="/register"
                className="group inline-flex items-center justify-center bg-transparent border-2 border-white text-white px-8 py-4 rounded-2xl font-bold text-lg hover:bg-white hover:text-red-600 transition-all duration-300 hover:scale-105 min-w-[250px]"
              >
                {language === 'fr' ? 'Créer un compte' : 'Create account'}
                <ChevronRight className="w-6 h-6 ml-3 group-hover:translate-x-1 transition-transform duration-300" />
              </Link>
            )}
          </div>

          {/* Note de confiance */}
          <p className="text-sm text-red-200 mt-8">
            {language === 'fr' 
              ? '✓ Paiement sécurisé • ✓ Remboursement si non disponible • ✓ Support 24/7'
              : '✓ Secure payment • ✓ Refund if unavailable • ✓ 24/7 support'
            }
          </p>
        </div>
      </div>
    </section>
  );
};

// Composant principal
const Home: React.FC = () => {
  const { language } = useApp();

  return (
    <Layout>
      <SEOHead
        title="SOS Expat & Travelers - Aide d'urgence pour expatriés francophones"
        description="Plateforme d'assistance urgente pour expatriés francophones. Connectez-vous avec des avocats et expatriés vérifiés partout dans le monde."
        structuredData={structuredData}
      />

      {/* Hero Section - Utilise le composant existant */}
      <HeroSection />

      {/* Profile Carousel - Utilise le composant existant */}
      <div className="bg-gradient-to-br from-red-50 via-white to-orange-50">
        <ProfileCarousel />
      </div>

      {/* Statistiques */}
      <StatsSection />

      {/* Services modernes */}
      <ServicesSection />

      {/* Map Section - Utilise le composant existant */}
      <div className="bg-gradient-to-br from-gray-50 to-blue-50">
        <WorldMap />
      </div>

      {/* Témoignages */}
      <TestimonialsSection />

      {/* Section inscription experts */}
      <ExpertSignupSection />

      {/* CTA Final */}
      <FinalCTASection />

      {/* Styles globaux pour les animations */}
      <style jsx global>{`
        @keyframes float {
%, 100% {
            transform: translateY(0px);
          }
          50% {
            transform: translateY(-10px);
          }
        }

        @keyframes pulse-glow {
%, 100% {
            box-shadow: 0 0 20px rgba(239, 68, 68, 0.3);
          }
          50% {
            box-shadow: 0 0 40px rgba(239, 68, 68, 0.5);
          }
        }

        .animate-float {
          animation: float 3s ease-in-out infinite;
        }

        .animate-pulse-glow {
          animation: pulse-glow 2s ease-in-out infinite;
        }

        /* Amélioration des transitions pour mobile */
        @media (max-width: 768px) {
          .group:hover {
            transform: none !important;
          }
          
          .group:active {
            transform: scale(0.95) !important;
          }
        }

        /* Optimisation des performances */
        * {
          -webkit-transform: translateZ(0);
          transform: translateZ(0);
          -webkit-backface-visibility: hidden;
          backface-visibility: hidden;
        }

        /* Amélioration du scroll smooth */
        html {
          scroll-behavior: smooth;
        }

        /* Custom scrollbar pour webkit */
        ::-webkit-scrollbar {
          width: 8px;
        }

        ::-webkit-scrollbar-track {
          background: #f1f1f1;
        }

        ::-webkit-scrollbar-thumb {
          background: linear-gradient(to bottom, #ef4444, #f97316);
          border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb:hover {
          background: linear-gradient(to bottom, #dc2626, #ea580c);
        }

        /* Amélioration de l'accessibilité */
        @media (prefers-reduced-motion: reduce) {
          *,
          *::before,
          *::after {
            animation-duration: 0.01ms !important;
            animation-iteration-count: 1 !important;
            transition-duration: 0.01ms !important;
          }
        }

        /* Focus amélioré pour l'accessibilité */
        .focus-visible:focus-visible {
          outline: 2px solid #3b82f6;
          outline-offset: 2px;
          border-radius: 8px;
        }

        /* Optimisation des images */
        img {
          content-visibility: auto;
        }

        /* Préchargement des polices critiques */
        @font-face {
          font-family: 'Inter';
          font-style: normal;
          font-weight: 400 900;
          font-display: swap;
          src: url('/fonts/inter-var.woff2') format('woff2');
        }

        /* Variables CSS pour la cohérence */
        :root {
          --primary-red: #ef4444;
          --primary-orange: #f97316;
          --gradient-primary: linear-gradient(135deg, var(--primary-red), var(--primary-orange));
          --shadow-primary: 0 10px 40px rgba(239, 68, 68, 0.2);
          --border-radius-lg: 1.5rem;
          --border-radius-xl: 2rem;
          --transition-primary: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        /* Amélioration des performances pour les animations */
        .will-change-transform {
          will-change: transform;
        }

        .will-change-opacity {
          will-change: opacity;
        }

        /* Optimisation tactile */
        .touch-manipulation {
          touch-action: manipulation;
        }

        /* États de hover améliorés */
        @media (hover: hover) {
          .hover-lift:hover {
            transform: translateY(-4px);
            box-shadow: var(--shadow-primary);
          }
        }

        /* Safe area pour les appareils avec encoche */
        @supports (padding: max(0px)) {
          .safe-area-top {
            padding-top: max(1rem, env(safe-area-inset-top));
          }
          
          .safe-area-bottom {
            padding-bottom: max(1rem, env(safe-area-inset-bottom));
          }
        }

        /* Amélioration de la lisibilité */
        .text-balance {
          text-wrap: balance;
        }

        /* Loading state pour les images */
        .img-loading {
          background: linear-gradient(90deg, #f0f0f0 25%, #e0e0e0 50%, #f0f0f0 75%);
          background-size: 200% 100%;
          animation: loading 1.5s infinite;
        }

        @keyframes loading {
% {
            background-position: 200% 0;
          }
          100% {
            background-position: -200% 0;
          }
        }
      `}</style>
    </Layout>
  );
};

export default Home;

